<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Alist</title>
    <url>/2023/03/13/Alist/</url>
    <content><![CDATA[<p>我自己搭建的一个网盘，对接了阿里云<br>
存了些视频 软件 系统 图片等杂七杂八的东西<br>
<a href="https://alist.xiaowine.cc/">点击进入</a></p>
]]></content>
      <categories>
        <category>分享</category>
      </categories>
      <tags>
        <tag>存储</tag>
        <tag>Alist</tag>
      </tags>
  </entry>
  <entry>
    <title>破解MIUI13之后深色模式只有部分软件能强制反色</title>
    <url>/2023/03/13/MiuiDarkList/</url>
    <content><![CDATA[<h3 id="历史原因">历史原因</h3>
<p>MIUI13开始，深色模式的强制反色改为了白名单模式<br>
白名单里的大多为热门大厂软件，小众软件以至于无法强制反色，晚上真的是亮瞎眼<br>
至于为什么改，看看小米社区环境就知道了</p>
<hr>
<h3 id="破解思路">破解思路</h3>
<p>既然有白名单，就要有地方存白名单的信息，我们可以从白名单文件下手，添加我们要强制反色的软件<br>
从深色这一词(<code>dark</code>)以及为线索，开始搜索文件名<br>
在 <code>/system/etc/</code>文件夹下发现了<code>ForceDarkAppSettings.json</code>文件，这就是MIUI13的白名单文件（MIUI14改到了<code>/system_ext/etc/forcedarkconfig/</code>文件夹下）</p>
<hr>
<h3 id="文件结构分析">文件结构分析</h3>
<p>我们先看看白名单文件部分内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;&quot;defaultEnable&quot;: true, &quot;overrideEnableValue&quot;: 0, &quot;packageName&quot;: &quot;com.sina.weibo&quot;, &quot;showInSettings&quot;: true&#125;,</span><br><span class="line">  &#123;&quot;defaultEnable&quot;: true, &quot;overrideEnableValue&quot;: 0, &quot;packageName&quot;: &quot;com.ss.android.article.news&quot;, &quot;showInSettings&quot;: true&#125;,</span><br><span class="line">  &#123;&quot;defaultEnable&quot;: true, &quot;overrideEnableValue&quot;: 0, &quot;packageName&quot;: &quot;com.snda.wifilocating&quot;, &quot;showInSettings&quot;: true&#125;,</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>白名单文件里是一个<code>Json</code>，由一个大的<code>List</code>包含着一个个<code>Map</code><br>
<code>List</code>没啥说的<br>
<code>Map</code>的数据我们拿第一个分析</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;defaultEnable&quot;: true, &quot;overrideEnableValue&quot;: 0, &quot;packageName&quot;: &quot;com.sina.weibo&quot;, &quot;showInSettings&quot;: true&#125;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>名字</th>
<th>值说明</th>
<th>数据类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>defaultEnable</td>
<td>是否启用</td>
<td>布尔值</td>
</tr>
<tr>
<td>overrideEnableValue</td>
<td>覆盖等级</td>
<td>整数</td>
</tr>
<tr>
<td>packageName</td>
<td>反色软件包名</td>
<td>字符串</td>
</tr>
<tr>
<td>showInSettings</td>
<td>是否在设置显示</td>
<td>布尔值</td>
</tr>
</tbody>
</table>
<p>那么如果我要添加一个软件在白名单里面，那么就添加一次<code>Map</code>在<code>List</code>里面</p>
<p>例如这样：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;&quot;defaultEnable&quot;: true, &quot;overrideEnableValue&quot;: 0, &quot;packageName&quot;: &quot;Com.bilibili.app.blue&quot;, &quot;showInSettings&quot;: true&#125;,</span><br><span class="line">  &#123;&quot;defaultEnable&quot;: true, &quot;overrideEnableValue&quot;: 0, &quot;packageName&quot;: &quot;tv.danmaku.bili&quot;, &quot;showInSettings&quot;: false&#125;,</span><br><span class="line">  &#123;&quot;defaultEnable&quot;: true, &quot;overrideEnableValue&quot;: 0, &quot;packageName&quot;: &quot;com.sina.weibo&quot;, &quot;showInSettings&quot;: true&#125;,</span><br><span class="line">  &#123;&quot;defaultEnable&quot;: true, &quot;overrideEnableValue&quot;: 0, &quot;packageName&quot;: &quot;com.ss.android.article.news&quot;, &quot;showInSettings&quot;: true&#125;,</span><br><span class="line">  &#123;&quot;defaultEnable&quot;: true, &quot;overrideEnableValue&quot;: 0, &quot;packageName&quot;: &quot;com.snda.wifilocating&quot;, &quot;showInSettings&quot;: true&#125;,</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>哔哩哔哩概念版 强制反色，并且在设置显示</li>
<li>哔哩哔哩 强制反色，但是并不在设置显示</li>
</ul>
<hr>
<h3 id="保存修改">保存修改</h3>
<p>目前据大部分新手机都是<code>EROFS</code>文件系统，旧手机是<code>EXT4</code>文件系统<br>
<code>EROFS</code>就算有ROOT权限都不能修改系统，<code>EXT4</code>有ROOT权限就能修改<br>
所以当你修改后保存，且给予了修改软件ROOT时，无法保存，那么你就是<code>EROFS</code>文件系统<br>
最简单的解决方法就是制作Magisk模块挂载修改过的文件，以达到修改目的白名单文件的目的</p>
<hr>
<h3 id="对比">对比</h3>
<table>
<thead>
<tr>
<th>修改前</th>
<th>修改后</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://i.postimg.cc/PxZYr4hj/Screenshot-2023-03-13-21-11-08-311-com-android-se.jpg" alt="Screenshot-2023-03-13-21-11-08-311-com-android-se.jpg"></td>
<td><img src="https://i.postimg.cc/tgtQF09v/1678713387793.jpg" alt="Screenshot-2023-03-13-21-11-08-311-com-android-se.jpg"></td>
</tr>
</tbody>
</table>
<hr>
<h3 id="懒人修改法">懒人修改法</h3>
<p>软件 <em>爱玩机工具箱</em> 有一键添加所有软件到白名单，并且制作Magisk模块刷入，懒人福音<br>
<a href="https://www.coolapk.com/apk/com.byyoung.setting">下载链接</a></p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>搞机</tag>
        <tag>MIUI</tag>
        <tag>破解</tag>
      </tags>
  </entry>
  <entry>
    <title>&lt;墨-状态栏歌词&gt;6.x更新简介</title>
    <url>/2023/07/25/%E6%9B%B4%E6%96%B0%E6%80%BB%E6%8F%8F%E8%BF%B0/</url>
    <content><![CDATA[<div class="note success no-icon flat"><p><a href="https://github.com/Block-Network/StatusBarLyric/releases">稳定版下载地址</a></p>
</div>
<div class="note warning no-icon flat"><p><a href="https://github.com/Block-Network/StatusBarLyric/actions/workflows/Android_Dev.yml">Dev下载地址</a></p>
</div>
<h2 id="《墨-状态栏歌词》全部重构">《墨-状态栏歌词》全部重构</h2>
<p><img src="https://raw.githubusercontent.com/Block-Network/StatusBarLyric/Dev/icon.png" alt="Icon"></p>
<p>经过一段时间的重写，《墨-状态栏歌词》已经全部重构，现在的版本相比以前的版本，更加的省电，性能占用更加的少，系统通用性更高，几乎适配所有系统</p>
<h3 id="Hook点原理改变">Hook点原理改变</h3>
<ul>
<li><code>6.x之前</code>的版本所有Hook点都是固定的，也就是说，不同系统，不同Android版本可能都需要单独适配，特别是国内定制化系统</li>
<li><code>6.x之后</code>寻找所有TextView（也就是显示文字的控件），再判断它的文字是否为当前时间，如果是，则有可能为状态栏的时间控件，记录下来，之后让用户选择一个能正常显示的，因为机器已经判断不出来了</li>
<li>
<mark class="hl-label green">优点</mark> ：适配99.9%的系统，并且适配部分官改
</li>
<li>
<mark class="hl-label red">缺点</mark> ：部分系统会出现玄学问题，比如在浅色与深色模式切换后失效，导致无法显示，这个问题目前还没有解决方案
</li>
</ul>
<h3 id="性能提升">性能提升</h3>
<ul>
<li><code>6.x之前</code>的的版本有大部分循环进行判断的代码，这种方式每秒要执行几次到几十次，资源占用较大</li>
<li><code>6.x之后</code>所有方法改为触发式，系统执行对应方法时才会触发这部分代码，大大减少了资源占用</li>
</ul>
<h3 id="更加实用的功能功能">更加实用的功能功能</h3>
<ul>
<li><code>6.x之后</code>
<ul>
<li>完善了 点击状态栏隐藏歌词</li>
<li>添加了 动态歌词速度（Beta）</li>
<li>More…</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>闲话</category>
      </categories>
      <tags>
        <tag>墨-状态栏歌词</tag>
      </tags>
  </entry>
</search>
